{"id":"claude-suite-01l","title":"Made a Sprite skill that OuterClaudes can use to drive InnerClaudes as test environments","description":"A skill enabling OuterClaude (local Claude Code) to control InnerClaude instances running in Sprites.dev VMs. Primary use case: testing workflows, install patterns, and Claude-to-Claude interaction.","design":"## Context\nThe breakthrough was discovering `pipe-pane` (not `capture-pane`) captures Claude's alternate screen buffer. This enables OuterClaude to see what InnerClaude outputs.\n\n## Key Pattern\n1. OuterClaude SSHs to sprite VM via `sprite exec`\n2. InnerClaude runs in tmux with `pipe-pane` capturing output\n3. Output requires `strings` filter to strip ANSI escapes\n4. NVM must be sourced with sprite-specific path\n\n## Gotchas\n- Raw pipe-pane output has ANSI escape codes — `cat file | strings | tail -100` makes it readable\n- NVM path on sprites: `export NVM_DIR=\"/.sprite/languages/node/nvm\" \u0026\u0026 . \"$NVM_DIR/nvm.sh\" \u0026\u0026 nvm use default`\n- OAuth tokens can leak in output — consider rotation","notes":"## Session 2026-01-19 (continued)\n\nCOMPLETED: Full OuterClaude/InnerClaude pattern validated\n\nKEY BREAKTHROUGH: OAuth token must be exported INSIDE the tmux session, not just outer shell. Checkpoints don't persist env vars.\n\nTESTED:\n- setup-token flow works (got fresh token)\n- Full pattern with token: tmux session → pipe-pane → NVM → export token → start claude → interact\n- Asked \"What is 2+2?\" → got \"2+2 equals 4.\"\n- Asked \"Capital of France?\" → got \"Paris.\"\n\nSKILL UPDATED:\n- Added Prerequisites: Authentication section\n- Added token export step (step 3) to Working Loop\n- Added verification steps (output file size, node process)\n- Updated Common Pitfalls and Troubleshooting\n\nSTATUS: Epic ready for child tasks (test script, -p docs)","status":"open","priority":2,"issue_type":"epic","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-19T21:45:25.629565Z","created_by":"spm1001","updated_at":"2026-01-19T22:05:29.261238Z"}
{"id":"claude-suite-01l.1","title":"Create test script that validates OuterClaude/InnerClaude pattern","description":"Create scripts/test-innerclaude.sh that validates the pipe-pane pattern works. Executable verification \u003e docs.","acceptance_criteria":"- [ ] Script exists at skills/sprite/scripts/test-innerclaude.sh\n- [ ] Script can be run from local machine against a sprite\n- [ ] Script validates: sprite restore, pipe-pane setup, simple query, output capture\n- [ ] Clear pass/fail output (exit codes + human-readable message)\n- [ ] Documents any prerequisites (sprite auth, checkpoint name)","status":"open","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-19T21:45:41.12364Z","created_by":"spm1001","updated_at":"2026-01-19T21:45:41.12364Z","dependencies":[{"issue_id":"claude-suite-01l.1","depends_on_id":"claude-suite-01l","type":"parent-child","created_at":"2026-01-19T21:45:41.124254Z","created_by":"spm1001"}]}
{"id":"claude-suite-01l.2","title":"Document -p + --output-format json alternative for non-interactive queries","description":"The -p flag with --output-format json provides a simpler approach for non-interactive queries. Documents structured output including permission_denials.","acceptance_criteria":"- [ ] Reference doc explains when to use -p vs interactive tmux\n- [ ] Shows example of structured JSON output\n- [ ] Documents permission_denials field for error handling\n- [ ] Clear guidance on which approach for which use case","status":"open","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-19T21:45:48.969379Z","created_by":"spm1001","updated_at":"2026-01-19T21:45:48.969379Z","dependencies":[{"issue_id":"claude-suite-01l.2","depends_on_id":"claude-suite-01l","type":"parent-child","created_at":"2026-01-19T21:45:48.969869Z","created_by":"spm1001"}]}
{"id":"claude-suite-01l.3","title":"Field Report: OAuth tokens expire within ~24h, breaking sprite checkpoints","description":"OuterClaude testing revealed auth is the practical blocker for the sprite pattern.","design":"## Context\nTesting the OuterClaude/InnerClaude pattern on 2026-01-19.\nRestored to v12 checkpoint (created 2026-01-18 with \"Fresh auth Jan 2026\").\n\n## Observation\nOAuth token was already expired 1 day later. `claude -p \"What is 2+2?\"` returned \"Invalid API key · Please run /login\".\n\nThis means:\n1. \"Golden checkpoints\" with auth cannot be relied upon for \u003e24h\n2. Every test session needs fresh auth or passed token\n3. CLAUDE_CODE_OAUTH_TOKEN env var is the practical path forward\n\n## Suggestion\n- Test script should validate auth before attempting InnerClaude\n- Consider documenting token refresh pattern\n- Explore whether API keys (not OAuth) persist longer","status":"closed","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-19T21:51:51.178372Z","created_by":"spm1001","updated_at":"2026-01-19T22:05:29.334988Z","closed_at":"2026-01-19T22:05:29.334988Z","close_reason":"Issue understood and fixed. Token must be exported inside tmux session. Skill updated with prerequisites, verification steps, and diagnostic sequence.","labels":["field-report"],"dependencies":[{"issue_id":"claude-suite-01l.3","depends_on_id":"claude-suite-01l","type":"parent-child","created_at":"2026-01-19T21:51:51.178935Z","created_by":"spm1001"}]}
{"id":"claude-suite-5nn","title":"Fix OuterClaude/InnerClaude pattern with -tty flag","description":"Test sprite exec -tty to establish proper PTY for the OuterClaude pattern. Current pattern fails because pipe-pane doesn't capture output when TTY isn't allocated. See SKILL.md Known Issue section for diagnostic details.","status":"closed","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-19T23:13:50.598619Z","created_by":"spm1001","updated_at":"2026-01-19T23:19:50.335877Z","closed_at":"2026-01-19T23:19:50.335877Z","close_reason":"Tested -tty flag: allocates /dev/pts/X, pipe-pane now captures both input AND output. Updated all sprite skill examples to use -tty."}
{"id":"claude-suite-t6v","title":"Field Report: Dot-notation hierarchy invisible in beads.txt and --parent queries","description":"Beads skill and tooling don't surface the implicit parent-child hierarchy that bd infers from dot notation (e.g., x9d.1 is auto-child of x9d). This causes confusion when orienting to a project.","design":"## Context\nOrienting to itv-slides-formatter project. User asked which epics the open beads fit into.\n\n## Observation\n1. `beads.txt` (generated by open-context.sh) showed x9d.1, cvf.4, x9d.4 as \"Standalone (no epic)\"\n2. `bd list --parent x9d` returned nothing\n3. Attempted `bd dep add x9d.1 x9d --type parent-child` — got error: \"already a child... would create deadlock\"\n4. So bd KNOWS about the implicit hierarchy but doesn't expose it in queries\n\nThe hierarchy exists and is enforced, but invisible to both the skill's context generator and CLI queries. Spent 5 minutes on a wild goose chase.\n\n## Suggestion\n1. `beads.txt` generator should recognize dot-notation children and nest them under parents\n2. `bd list --parent` should include implicit dot-notation children\n3. Or: document this behavior prominently in the skill so Claude doesn't waste time \"fixing\" something that's already correct","status":"open","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-19T22:37:34.663266Z","created_by":"spm1001","updated_at":"2026-01-19T22:37:34.663266Z","labels":["field-report"]}
